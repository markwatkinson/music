<div class='bar'>
    <div class='playback-controls'>
        <!-- need to do something about all this... -->
        <a href='#' class='control'
        data-bind="text: ($root.playlist.paused() || !$root.playlist.playing())? 'Play' : 'Pause',
            click: function() {
                console.log($root.playlist.playing(), $root.playlist.paused());
                if (!$root.playlist.playing() || $root.playlist.paused()) $root.playlist.play();
                else $root.playlist.pause();
            },
            css : {
                'play' : !$root.playlist.playing() || $root.playlist.paused(),
                'pause': $root.playlist.playing() &amp;&amp; !$root.playlist.paused()
            }
        "></a>
        <a href='#' data-bind="click: $root.playlist.stop" class='control stop'>Stop</a>
        <a href='#' data-bind="click: $root.playlist.next" class='control next'>Next</a>
        <input type="range" step="any" id="seekbar" min=0 data-bind="attr: {max: $root.playlist.currentSongLength()},
            value: $root.playlist.seek"></input>
    </div>

    <!-- ko if: $root.playlist.currentSong -->
        <!-- ko with: $root.playlist.currentSong -->
        <div class='now-playing'
            data-bind='style: { backgroundImage: "url(/art/" + path() + "?s=96)" }'
        >
            <span class='title song-title' data-bind='text: title'></span>
            <span class='title artist-name' data-bind='text: album.artist.name'></span>
            <span class='title album-title' data-bind='text: album.title'></span>
        </div>
        <!-- /ko -->
    <!-- /ko -->

    <div class='playlist-controls'>
        <a href='#' data-bind="click: $root.playlist.selection.remove">Delete selected</a>
        <a href='#' data-bind="click: $root.playlist.clear">Clear</a>
        <br/>
        <a href='#' data-bind="click: $root.playlist.save">Save</a>
        <a href='#' data-bind="click: $root.playlist.load">Load</a>
        
    </div>
</div>
<table class='grid'
    tabindex="1"
    data-bind="with: $root.playlist,
        event: { 
            click: function(data, event) { event.target.focus(); },
            keydown: function(data, event){ return $root.playlist.selection.keyPress(event); },
            dragover: function(data, event){event.stopPropagation(); event.preventDefault(); return true; },
            drop: function(data, event){ $root.playlist.drop(event); }
        }
    ">

    <thead>
        <th data-bind="click: sortBy.bind($data, 'trackNo')">#</th> 
        <th data-bind="click: sortBy.bind($data, 'title')">Title</th>
        <th data-bind="click: sortBy.bind($data, 'artist')">Artist</th> 
        <th data-bind="click: sortBy.bind($data, 'album')">Album</th> 
        <th data-bind="click: sortBy.bind($data, 'year')">Year</th> 
        <th data-bind="click: sortBy.bind($data, 'length')">Length</th>
    </thead>
    <tbody data-bind="foreach: songs">
        <tr
            draggable='true'
            data-bind="css: {
                current : $index() == $root.playlist.index(),
                selected: playlistData.selected()
            }, 
            event: {
                click: function(data, event) { $root.playlist.selection.click(event, $index()) },
                dblclick: function(){$root.playlist.playIndex( $index() )},
                dragstart: function(data, event){$root.playlist.dragStart(event, data); return true},
            }">
            <td data-bind="text: trackNo"></td>
            <td data-bind="text: title"></td>
            <td data-bind="text: album.artist.name"></td>
            <td data-bind="text: album.title"></td>
            <td data-bind="text: album.year"></td>
            <td data-bind="text: prettyLength"></td>
        </tr>
    </tbody>

</table>

